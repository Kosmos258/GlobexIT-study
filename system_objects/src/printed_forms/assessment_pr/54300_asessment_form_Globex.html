<%
	try
	{
		curObjectID;
	}
	catch(e0)
	{
		try
		{
			curObject = TopElem;
			curObjectID = curObject.Doc.DocID;
		}
		catch(e1)
		{
			curObjectID = 0;
			curObject = null;
			Cancel();
		}
	}

	try
	{
		curLngWeb;
		var sConst_ass_estimated_person = tools_web.get_web_const( "ass_estimated_person", curLngWeb );
		var sConst_c_position = tools_web.get_web_const( "c_position", curLngWeb );
		var sConst_c_subd = tools_web.get_web_const( "c_subd", curLngWeb );
		var sConst_c_boss = tools_web.get_web_const( "c_boss", curLngWeb );
		var sConst_ass_competence = tools_web.get_web_const( "ass_competence", curLngWeb );
		var sConst_ks3idixed9 = tools_web.get_web_const( "ks3idixed9", curLngWeb );
		var sConst_vsb_expected_result = tools_web.get_web_const( "vsb_expected_result", curLngWeb );
		var sConst_task_type = tools_web.get_web_const( "c_type", curLngWeb );
		var sConst_task_name = tools_web.get_web_const( "naimenovanie", curLngWeb );
	}
	catch(e)
	{
		var sConst_ass_estimated_person = "Оцениваемый сотрудник";
		var sConst_c_position = "Должность";
		var sConst_c_subd = "Подразделение";
		var sConst_c_boss = "Руководитель";
		var sConst_ass_competence = "Компетенция";
		var sConst_ks3idixed9 = "Способ развития";
		var sConst_vsb_expected_result = "Ожидаемый результат";
		var sConst_task_type = "Тип";
		var sConst_task_name = "Наименование";
	}

%>
<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:x="urn:schemas-microsoft-com:office:excel"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1251">
<meta name=ProgId content=Excel.Sheet>
<meta name=Generator content="Microsoft Excel 15">
<link rel=File-List href="_filelist.xml">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
x\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<style id="ddd">
<!--
table {mso-displayed-decimal-separator:"\,"; mso-displayed-thousand-separator:" ";}

/*Кастомные стили */
.section_style {padding:0px; mso-ignore:padding; color:black; font-size:12.0pt; font-weight:700; font-style:normal; text-decoration:none; font-family:Arial, sans-serif; mso-font-charset:204; text-align:start; vertical-align:middle; background: #A6A6A6; mso-pattern:black none; white-space:normal; border: none}
.td-general-info {padding:0px; height:20px; mso-ignore:padding; color:black; font-size:10.0pt; font-style:normal; text-decoration:none; font-family:Arial, sans-serif; mso-font-charset:204; text-align:start; vertical-align:middle; mso-pattern:black none; white-space:nowrap;}
.competence-table-header {border: thin solid black; padding:0px; height:70px; mso-ignore:padding; color:black; font-size:10.0pt; font-weight:700; font-style:normal; text-decoration:none; font-family:Arial, sans-serif; mso-font-charset:204; text-align:center; background: #D9D9D9; vertical-align:middle; mso-pattern:black none; white-space:normal;}
.td-competence-name {border: thin solid black; padding:0px; height:20px; mso-ignore:padding; color:black; font-size:10.0pt; font-weight:700; font-style:normal; text-decoration:none; font-family:Arial, sans-serif; mso-font-charset:204; text-align:left; background: #F2F2F2; vertical-align:middle; mso-pattern:black none; white-space:normal;}
.td-competence {border: thin solid black; padding:0px; height:20px; mso-ignore:padding; color:black; font-size:10.0pt; font-weight:700; font-style:normal; text-decoration:none; font-family:Arial, sans-serif; mso-font-charset:204; text-align:center; background: #F2F2F2; vertical-align:middle; mso-pattern:black none; white-space:nowrap;}
.td-indicator-name {border: thin solid black; padding:0px; mso-ignore:padding; color:black; font-size:10.0pt; font-style:normal; text-decoration:none; font-family:Arial, sans-serif; mso-font-charset:204; text-align:left; vertical-align:middle; mso-pattern:black none; white-space:normal;}
.td-indicator {border: thin solid black; padding:0px; mso-ignore:padding; color:black; font-size:10.0pt; font-style:normal; text-decoration:none; font-family:Arial, sans-serif; mso-font-charset:204; text-align:center; vertical-align:middle; mso-pattern:black none; white-space:normal;}

-->
</style>
</head>

<body>
<!--[if !excel]>&nbsp;&nbsp;<![endif]-->
<!--      -
Microsoft Excel.-->
<!--      Excel    
DIV  .-->
<!----------------------------->
<!--    - EXCEL -->
<!----------------------------->

<div id="ddd" align=center
x:publishsource="Excel">

<table border=0 cellpadding=0 cellspacing=0 width=931 style='border-collapse:collapse;table-layout:fixed;width:697pt'>
	<colgroup>
		<col style="width:470px;mso-width-source:userset">
		<col style="width:190px;mso-width-source:userset">
		<col style="width:190px;mso-width-source:userset">
		<col style="width:190px;mso-width-source:userset">
		<col style="width:190px;mso-width-source:userset">
		<col style="width:140px;mso-width-source:userset">
		<col style="width:140px;mso-width-source:userset">
		<col style="width:140px;mso-width-source:userset">
		<col style="width:140px;mso-width-source:userset">
		<col style="width:140px;mso-width-source:userset">
		<col style="width:140px;mso-width-source:userset">
	</colgroup>

	<%
    var sPersonFullname = curObject.person_id.sd.fullname;
	var sPersonPositionName = curObject.person_id.sd.position_name;
    var sPersonOrgName = curObject.person_id.sd.org_name;
    var sExpertFullname = curObject.expert_person_id.sd.fullname;
    var sExpertPositionName = curObject.expert_person_id.sd.position_name;

	var docAssessmentPlan = tools.open_doc(curObject.assessment_plan_id);
    var teAssessmentPlan = docAssessmentPlan.TopElem;
    var sWorkflowStepName = teAssessmentPlan.workflow_state_name;

	var docPerson = tools.open_doc(curObject.person_id);
	var tePerson = docPerson.TopElem;
	var sPersonSubHierarchy = tools.person_list_staff_by_person_id(curObject.person_id, tePerson, 15, 1, "/ ");
	//var sPersonSubHierarchy = ArrayMerge(fnReverseArray(fnGetSubHierarchy(tePerson.position_parent_id)), "This", "/ ");

	var docAssessmentAppraise = tools.open_doc(curObject.assessment_appraise_id);
	var teAssessmentAppraise = docAssessmentAppraise.TopElem;

	var sAssessmentAppraiseName = teAssessmentAppraise.name;
	var sAssessmentStartDate = (teAssessmentAppraise.start_date.HasValue ? StrDate(teAssessmentAppraise.start_date, false, false) : "");
	var sAssessmentEndDate = (teAssessmentAppraise.end_date.HasValue ? StrDate(teAssessmentAppraise.end_date, false, false) : "");

	  //------------------------Раздел «Оценка компетенций сотрудника»------------------------------------------------

	  try {
		  var pa, paDocTe, competence, indicator, curCompetence, curIndicator
		  var competencesArr = []
		  var indicators = []
		  var managerPaCount = 0
		  var matrixManagerPaCount = 0
		  var staffPaCount = 0
		  var averageCount = 1

	      var pasQuery = tools.xquery("for $elem in pas where assessment_plan_id = " + curObject.assessment_plan_id + " and assessment_appraise_type = 'competence_appraisal' and person_id = " + curObject.person_id + " return $elem")

		  var curCompPa = tools.open_doc(ArrayOptFirstElem(pasQuery).id).TopElem
		  for (competence in curCompPa.competences) {
			  indicators = []

			  for (indicator in competence.indicators) {
				  indicators.push({
					  id: indicator.indicator_id.Value,
					  name: indicator.indicator_id.OptForeignElem.name.Value,
					  selfMark: 0.0,
					  mainBossMark: 0.0,
					  matrixBossMark: 0.0,
					  staffMark: 0.0,
					  totalMark: 0.0
				  })
			  }

			  competencesArr.push({
				  id: competence.competence_id.Value,
				  name: competence.competence_id.OptForeignElem.name.Value,
				  selfMark: 0.0,
				  mainBossMark: 0.0,
                  matrixBossMark: 0.0,
				  staffMark: 0.0,
				  totalMark: 0.0,
				  indicators: indicators
			  })
		  }

		  for (pa in pasQuery) {
			paDocTe = tools.open_doc(pa.id.Value).TopElem

			  //Добавление оценок по типу анкеты Самооценка
			  if (paDocTe.status.Value == "self") {
				  for (competence in paDocTe.competences) {
					  curCompetence = ArrayOptFind(competencesArr, "id==" + competence.competence_id.Value)
	                  if (curCompetence == undefined) continue
					  curCompetence.selfMark += OptReal(competence.GetOptProperty("mark_value", 0.0), 0.0)

					  for (indicator in competence.indicators) {
						  curIndicator = ArrayOptFind(curCompetence.indicators, "id==" + indicator.indicator_id.Value)
						  curIndicator.selfMark += OptReal(indicator.GetOptProperty("mark_value", 0.0), 0.0)
					  }
				  }
			  }

			//Добавление оценок по типу анкеты Руководитель
			  if (paDocTe.status.Value == "manager") {
				  for (competence in paDocTe.competences) {
					   curCompetence = ArrayOptFind(competencesArr, "id==" + competence.competence_id.Value)
                       if (curCompetence == undefined) continue

                       if (teAssessmentPlan.expert_person_id.Value == paDocTe.expert_person_id.Value) {
                           curCompetence.matrixBossMark = OptReal(competence.GetOptProperty("mark_value", 0.0), 0.0)
                           matrixManagerPaCount = matrixManagerPaCount + 1
                       } else {
                           curCompetence.mainBossMark = OptReal(competence.GetOptProperty("mark_value", 0.0), 0.0)
                           managerPaCount = managerPaCount + 1
                       }

					  for (indicator in competence.indicators) {
						  curIndicator = ArrayOptFind(curCompetence.indicators, "id==" + indicator.indicator_id.Value)
							if (teAssessmentPlan.expert_person_id.Value == paDocTe.expert_person_id.Value) {
								curIndicator.matrixBossMark = OptReal(indicator.GetOptProperty("mark_value", 0.0), 0.0)
							} else {
								curIndicator.mainBossMark = OptReal(indicator.GetOptProperty("mark_value", 0.0), 0.0)
							}
					  }
				  }
			  }

			  //Добавление оценок по типу анкеты Подчиненные
			  if (paDocTe.status.Value == "staff") {
				  for (competence in paDocTe.competences) {
					  curCompetence = ArrayOptFind(competencesArr, "id==" + competence.competence_id.Value)
					  if (curCompetence == undefined) continue
					  curCompetence.staffMark += OptReal(competence.GetOptProperty("mark_value", 0.0), 0.0)

					  for (indicator in competence.indicators) {
						  curIndicator = ArrayOptFind(curCompetence.indicators, "id==" + indicator.indicator_id.Value)
						  curIndicator.staffMark += OptReal(indicator.GetOptProperty("mark_value", 0.0), 0.0)
					  }
				  }
				  staffPaCount = staffPaCount + 1
			  }
		  }

		  if (managerPaCount) {
			averageCount += 1
		  }
		  if (matrixManagerPaCount) {
			averageCount += 1
		  }
		  if (staffPaCount) {
			averageCount += 1
		  }

		  for (competence in competencesArr) {
			  competence.staffMark = (staffPaCount ? competence.staffMark / staffPaCount : competence.staffMark)
			  for (indicator in competence.indicators) {
				  indicator.staffMark = (staffPaCount ? indicator.staffMark / staffPaCount : indicator.staffMark)
	  			  indicator.totalMark = (indicator.selfMark + indicator.mainBossMark + indicator.matrixBossMark + indicator.staffMark) / averageCount
			  }
	  		  competence.totalMark = (competence.selfMark + competence.mainBossMark + competence.matrixBossMark + competence.staffMark) / averageCount
		  }
	  } catch(ex) {
	  	alert('Раздел «Оценка компетенций сотрудника»: ' + ex)
	  }

	  //------------------------Раздел «Информация по целям и метрикам»------------------------------------------------

	function statusName(status) {
		var oStatuses = {
			n: "Проект",
			p: "Планируется",
			r: "Подготовлена",
			0: "Выполняется",
			1: "Не выполнена",
			x: "Отменена"
		}
		return oStatuses.GetOptProperty(status, status)
	}

	  try {
		  var task, taskDocTe, paForTask, paTaskTe, paTaskDoc, paTask, curTaskObj, oGoal, oMetric
		  var allTasksArr = []
		  var finalTasksArr = []
		  var oTask = {}
		  var childrenTasksArr = []
		  var pasForTasksQuery = tools.xquery("for $elem in pas where assessment_plan_id = " + curObject.assessment_plan_id + " and assessment_appraise_type = 'staffrating' and person_id = " + curObject.person_id + " and status = 'manager' order by $elem/index descending return $elem")
		  var maxIndex = ArrayOptFirstElem(pasForTasksQuery).index.Value

		  for (paForTask in pasForTasksQuery) {
			  paTaskDoc = tools.open_doc(paForTask.id.Value)
			  if (paTaskDoc == undefined) continue

			  paTaskTe = paTaskDoc.TopElem

			  //Заполнение целей и метрик
			  for (paTask in paTaskTe.tasks) {
				  taskDocTe = tools.open_doc(paTask.task_id.Value).TopElem
				  oTask = {}

				  curTaskObj = ArrayOptFind(allTasksArr, "name==" + CodeLiteral(taskDocTe.name.Value))
				  if (curTaskObj == undefined) {
					  oTask.SetProperty("id", taskDocTe.id.Value)
					  oTask.SetProperty("name", taskDocTe.name.Value)
					  oTask.SetProperty("description", HtmlToPlainText(taskDocTe.desc.Value))
					  if (paForTask.index.Value == maxIndex) {
						oTask.SetProperty("weight", paTask.weight.Value)
					  } else {
						oTask.SetProperty("weight", 0)
					  }
					  if (IsEmptyValue(taskDocTe.GetOptProperty("parent_task_id", ""))) {
						  oTask.SetProperty("type", "")
					  } else {
						oTask.SetProperty("type", taskDocTe.task_type_id.OptForeignElem.name)
					  }
					  oTask.SetProperty("plan", taskDocTe.GetOptProperty("plan", "").Value)
					  oTask.SetProperty("calculateResult", taskDocTe.custom_fields.ObtainChildByKey("calculate_result").value.Value)
					  oTask.SetProperty("parentTaskID", taskDocTe.GetOptProperty("parent_task_id", "").Value)
				  } else {
					oTask = curTaskObj
				  }

				  if (taskDocTe.status.Value == "x" || String(paForTask.index) == '500') {
					 oTask.SetProperty("status", statusName(taskDocTe.status.Value))
				  }
				  if (StrContains(Trim(paForTask.budget_period_id.OptForeignElem.name.Value), "Контроль Июль-Сентябрь", true)) {
				  	oTask.SetProperty("controlJulySeptember", taskDocTe.GetOptProperty("value", "-").Value)
				  }
				  if (StrContains(Trim(paForTask.budget_period_id.OptForeignElem.name.Value), "Контроль Октябрь-Декабрь", true)) {
				  	oTask.SetProperty("controlOctoberDecember", taskDocTe.GetOptProperty("value", "-").Value)
				  }
				  if (StrContains(Trim(paForTask.budget_period_id.OptForeignElem.name.Value), "Контроль Январь-Март", true)) {
				  	oTask.SetProperty("controlJanuaryMarch", taskDocTe.GetOptProperty("value", "-").Value)
				  }
				  if (StrContains(Trim(paForTask.budget_period_id.OptForeignElem.name.Value), "Контроль Апрель-Июнь", true)) {
				  	oTask.SetProperty("controlAprilJune", taskDocTe.GetOptProperty("value", "-").Value)
				  }

				 if (String(paForTask.index) == '500') {
					  oTask.SetProperty("intermediateMark", taskDocTe.custom_fields.ObtainChildByKey("calculated").value.Value)
					  oTask.SetProperty("totalMark", taskDocTe.GetOptProperty("value", "-").Value)
				  }

				  if (curTaskObj == undefined) {
					allTasksArr.push(oTask)
				  }
			  }
		  }
	//tools.log('allTasksArr: ' + tools.object_to_text(allTasksArr, 'json'));

		  //Целям присваиваются метрики
		  for (task in allTasksArr) {
			  if (!IsEmptyValue(task.parentTaskID)) continue

			  childrenTasksArr = ArraySelect( allTasksArr, "parentTaskID == " + task.id )
			  task.SetProperty("childTasks", childrenTasksArr)

			  finalTasksArr.push(task)
		  }
	//tools.log('finalTasksArr: ' + tools.object_to_text(finalTasksArr, 'json'));

	  } catch(ex) {
	  	alert('Раздел «Информация по целям и метрикам»: ' + ex)
	  }
%>

	<tr>
		<td colspan=5 rowspan=1 height=25 class=section_style>Общие сведения</td>
	</tr>
	<tr>
		<td colspan=5 rowspan=1 height=20></td>
	</tr>

	<tr>
		<td class=td-general-info style="font-weight: bold">Наименование процедуры</td>
		<td class=td-general-info><%=sAssessmentAppraiseName%></td>
	</tr>
	<tr>
		<td class=td-general-info style="font-weight: bold">Оцениваемый сотрудник</td>
		<td class=td-general-info><%=sPersonFullname%></td>
	</tr>
	<tr>
		<td class=td-general-info style="font-weight: bold">Должность</td>
		<td class=td-general-info><%=sPersonPositionName%></td>
	</tr>
	<tr>
		<td class=td-general-info style="font-weight: bold">Подразделение</td>
		<td class=td-general-info><%=sPersonSubHierarchy%></td>
	</tr>
	<tr>
		<td class=td-general-info style="font-weight: bold">Руководитель</td>
		<td class=td-general-info><%=sExpertFullname%></td>
	</tr>
	<tr>
		<td class=td-general-info style="font-weight: bold">Должность</td>
		<td class=td-general-info><%=sExpertPositionName%></td>
	</tr>
	<tr>
		<td class=td-general-info style="font-weight: bold">Этап плана оценки</td>
		<td class=td-general-info><%=sWorkflowStepName%></td>
	</tr>
	<tr>
		<td class=td-general-info style="font-weight: bold">Дата выгрузки</td>
		<td class=td-general-info>&lrm;<%=StrDate(Date())%></td>
	</tr>
	<tr >
		<td height="40"></td>
	</tr>
	<td colspan=6 rowspan=1 height=25 class=section_style>Оценка компетенций</td>
	<tr>
		<td colspan=6 rowspan=1 height=20></td>
	</tr>

	<tr style='mso-height-source:userset; mso-width-source: userset;'>
		<td class=competence-table-header>Наименование компетенции/индикатора</td>
		<td class=competence-table-header>Самооценка</td>
		<td class=competence-table-header>Оценка непосредственного руководителя</td>
		<td class=competence-table-header>Оценка матричного руководителя</td>
		<td class=competence-table-header>Оценка подчиненных</td>
		<td class=competence-table-header>Итоговая оценка</td>
		<td colspan=6></td>
	</tr>

<%
	for (oComp in competencesArr) {
%>
	<tr style='mso-height-source:userset; mso-width-source: userset;'>
		<td class=td-competence-name><%=oComp.name%></td>
		<td class=td-competence style="mso-number-format:'0\.00'"><%=oComp.selfMark%></td>
		<td class=td-competence style="mso-number-format:'0\.00'"><%=oComp.mainBossMark%></td>
		<td class=td-competence style="mso-number-format:'0\.00'"><%=oComp.matrixBossMark%></td>
		<td class=td-competence style="mso-number-format:'0\.00'"><%=oComp.staffMark%></td>
		<td class=td-competence style="mso-number-format:'0\.00'"><%=oComp.totalMark%></td>
		<td colspan=6></td>
	</tr>
<%
		for (oInd in oComp.indicators) {
			%>
				<tr>
					<td class=td-indicator-name><%=oInd.name%></td>
					<td class=td-indicator style="mso-number-format:'0\.00'"><%=oInd.selfMark%></td>
					<td class=td-indicator style="mso-number-format:'0\.00'"><%=oInd.mainBossMark%></td>
					<td class=td-indicator style="mso-number-format:'0\.00'"><%=oInd.matrixBossMark%></td>
					<td class=td-indicator style="mso-number-format:'0\.00'"><%=oInd.staffMark%></td>
					<td class=td-indicator style="mso-number-format:'0\.00'"><%=oInd.totalMark%></td>
					<td colspan=6></td>
				</tr>
			<%
		}
	}
%>
	<tr>
		<td colspan=5 rowspan=1 height=20></td>
	</tr>
	<td colspan=11 rowspan=1 height=25 class=section_style>Оценка по целям</td>
	<tr>
		<td colspan=11 rowspan=1 height=20></td>
	</tr>
	<td colspan=11 rowspan=1 height=25 class=section_style>Итоговая оценка по всем целям:</td>

<%
	for (oGoal in finalTasksArr) {
%>
	<tr style='mso-height-source:userset; mso-width-source: userset; height: 65px' >
		<td class=competence-table-header>Цель/Метрика</td>
		<td class=competence-table-header>Вес</td>
		<td class=competence-table-header colspan=2">Описание</td>
		<td class=competence-table-header>Статус из годовой оценки и отмененные</td>
		<td class=competence-table-header>Контроль Июль-Сентябрь</td>
		<td class=competence-table-header>Контроль Октябрь-Декабрь</td>
		<td class=competence-table-header>Контроль Январь-Март </td>
		<td class=competence-table-header>Контроль Апрель-Июнь </td>
		<td class=competence-table-header>Промежуточная оценка </td>
		<td class=competence-table-header>Итоговая оценка </td>
	</tr>
	<tr >
		<td class=td-indicator-name><%=oGoal.name%></td>
		<td class=td-indicator><%=oGoal.weight%></td>
		<td class=td-indicator colspan=2><%=oGoal.description%></td>
		<td class=td-indicator><%=oGoal.GetOptProperty("status", "")%></td>
		<td class=td-indicator style="mso-number-format:'0\.00'"><%=oGoal.GetOptProperty("controlJulySeptember", "")%></td>
		<td class=td-indicator style="mso-number-format:'0\.00'"><%=oGoal.GetOptProperty("controlOctoberDecember", "")%></td>
		<td class=td-indicator style="mso-number-format:'0\.00'"><%=oGoal.GetOptProperty("controlJanuaryMarch", "")%></td>
		<td class=td-indicator style="mso-number-format:'0\.00'"><%=oGoal.GetOptProperty("controlAprilJune", "")%></td>
		<td class=td-indicator style="mso-number-format:'0\.00'"><%=oGoal.GetOptProperty("intermediateMark", "")%></td>
		<td class=td-indicator style="mso-number-format:'0\.00'"><%=oGoal.GetOptProperty("totalMark", "")%></td>
	</tr>
	<%
	if (oGoal.childTasks.length > 0) {
	%>
		<tr style='mso-height-source:userset; mso-width-source: userset; height: 65px' >
			<td class=competence-table-header>Метрика</td>
			<td class=competence-table-header>Тип</td>
			<td class=competence-table-header>Целевое значение</td>
			<td class=competence-table-header>Как считать результат</td>
			<td class=competence-table-header>Статус из годовой оценки и отмененные</td>
			<td class=competence-table-header>Контроль Июль-Сентябрь</td>
			<td class=competence-table-header>Контроль Октябрь-Декабрь</td>
			<td class=competence-table-header>Контроль Январь-Март </td>
			<td class=competence-table-header>Контроль Апрель-Июнь </td>
			<td class=competence-table-header>Промежуточная оценка </td>
			<td class=competence-table-header>Итоговая оценка </td>
		</tr>
	<%
	}
		for (oMetric in oGoal.childTasks) {
	%>
			<tr>
				<td class=td-indicator-name><%=oMetric.name%></td>
				<td class=td-indicator><%=oMetric.type%></td>
				<td class=td-indicator><%=oMetric.plan%></td>
				<td class=td-indicator><%=oMetric.calculateResult%></td>
				<td class=td-indicator><%=oMetric.GetOptProperty("status", "")%></td>
				<td class=td-indicator style="mso-number-format:'0\.00'"><%=oMetric.GetOptProperty("controlJulySeptember", "")%></td>
				<td class=td-indicator style="mso-number-format:'0\.00'"><%=oMetric.GetOptProperty("controlOctoberDecember", "")%></td>
				<td class=td-indicator style="mso-number-format:'0\.00'"><%=oMetric.GetOptProperty("controlJanuaryMarch", "")%></td>
				<td class=td-indicator style="mso-number-format:'0\.00'"><%=oMetric.GetOptProperty("controlAprilJune", "")%></td>
				<td class=td-indicator style="mso-number-format:'0\.00'"><%=oMetric.GetOptProperty("intermediateMark", "")%></td>
				<td class=td-indicator style="mso-number-format:'0\.00'"><%=oMetric.GetOptProperty("totalMark", "")%></td>
			</tr>
<%
		}
	}
%>

<!--  -------------------------------------------------------------------------------	-->

</table>

</div>


<!----------------------------->
<!--    - EXCEL-->
<!----------------------------->
</body>

</html>
